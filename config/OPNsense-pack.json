{
  "v": 1,
  "id": "18182b58-b61f-429b-baeb-3c28916d5541",
  "rev": 1,
  "name": "OPNsense Dashboard",
  "summary": "This pack includes everything needed to setup Graylog for the dashboard.",
  "description": "",
  "vendor": "Bsmith101",
  "url": "https://github.com/Bsmith101/OPNsense-Dashboard",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "a28e2142-8680-4f19-84e8-5f80380f5685",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "GeoIP Cache"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 1
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "30310c34-94ed-4733-b850-2aa7394f453a",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "OPNsense / filterlog"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "CONTAINS"
            },
            "field": {
              "@type": "string",
              "@value": "message"
            },
            "value": {
              "@type": "string",
              "@value": "filterlog"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "OPNsense filter logs"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "04716e76-d03f-47da-8f96-826edfa201d4",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"GeoIP\"\nstage 0 match either\nrule \"GeoIP lookup: src_ip\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "30310c34-94ed-4733-b850-2aa7394f453a"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "77e1882f-e27f-4ad6-8e59-a08396073654",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "description": {
          "@type": "string",
          "@value": "Geo IP Lookup Table"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/usr/share/graylog/data/data/GeoLite2-Country.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_COUNTRY"
          },
          "check_interval": {
            "@type": "long",
            "@value": 1
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "69838991-3e6b-418c-97af-77ba3b3774c4",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GeoIP lookup: src_ip"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"GeoIP lookup: src_ip\"\nwhen\nhas_field(\"src_ip\")\nthen\nlet geo = lookup(\"geoip\", to_string($message.\"src_ip\"));\nset_field(\"src_ip_geo_location\", geo[\"coordinates\"]);\nset_field(\"src_ip_geo_country\", geo[\"country\"].iso_code);\nset_field(\"src_ip_geo_city\", geo[\"city\"].names.en);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "1dd3a84d-8767-4032-8ec6-59a3e6248be2",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a28e2142-8680-4f19-84e8-5f80380f5685"
        },
        "name": {
          "@type": "string",
          "@value": "geoip"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "77e1882f-e27f-4ad6-8e59-a08396073654"
        },
        "title": {
          "@type": "string",
          "@value": "GeoIP"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Geo IP Lookup"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "9a48cd75-bbd9-48dd-bf34-21014842be82",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Syslog UDP"
        },
        "configuration": {
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "port": {
            "@type": "integer",
            "@value": 1514
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 6
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=4.2.1+5442e44"
        }
      ]
    }
  ]
}
